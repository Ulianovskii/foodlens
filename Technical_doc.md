# –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è FoodLens

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
1. [–û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ](#–æ–±—â–µ–µ-–æ–ø–∏—Å–∞–Ω–∏–µ)
2. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
3. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
4. [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–∑–∞–ø—É—Å–∫)
5. [–†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö](#—Ä–∞–±–æ—Ç–∞-—Å-–±–∞–∑–æ–π-–¥–∞–Ω–Ω—ã—Ö)
6. [–°–∏—Å—Ç–µ–º–∞ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏](#—Å–∏—Å—Ç–µ–º–∞-–ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏)
7. [–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π](#–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏-—Å–æ–æ–±—â–µ–Ω–∏–π)
8. [–°–µ—Ä–≤–∏—Å—ã –∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞](#—Å–µ—Ä–≤–∏—Å—ã-–∏-–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)
9. [–†–∞–±–æ—Ç–∞ —Å GPT API](#—Ä–∞–±–æ—Ç–∞-—Å-gpt-api)
10. [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
11. [–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π](#—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞-–Ω–æ–≤—ã—Ö-—Ñ—É–Ω–∫—Ü–∏–π)

## –û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

**FoodLens** - Telegram –±–æ—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –µ–¥—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º AI. –ë–æ—Ç –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å, –ë–ñ–£ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–µ—Ü–µ–ø—Ç—ã –±–ª—é–¥.

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫:**
- Python 3.11+
- Aiogram 3.x (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è Telegram)
- PostgreSQL (–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)
- OpenAI GPT-4 Vision API (–∞–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
- Docker (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

### –ü—Ä–∏–Ω—Ü–∏–ø—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:
- **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å** - –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –º–æ–¥—É–ª–µ
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å** - –≤–µ—Å—å –∫–æ–¥ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º–æ—Å—Ç—å** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —á–µ—Ä–µ–∑ .env —Ñ–∞–π–ª
- **–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è** - –≤—Å–µ —Ç–µ–∫—Å—Ç—ã –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
```
app/
‚îú‚îÄ‚îÄ handlers/     # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –∫–æ–º–∞–Ω–¥
‚îú‚îÄ‚îÄ services/     # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –∏ –≤–Ω–µ—à–Ω–∏–µ API
‚îú‚îÄ‚îÄ models/       # –ú–æ–¥–µ–ª–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ locales/      # –°–∏—Å—Ç–µ–º–∞ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ keyboards/    # –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã –∏ –∫–Ω–æ–ø–∫–∏
‚îú‚îÄ‚îÄ core/         # –Ø–¥—Ä–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ prompts/      # –ü—Ä–æ–º—Ç—ã –¥–ª—è GPT
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

### –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã –∏ –ø–∞–ø–∫–∏:

```
foodlens/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ bot.py                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ handlers/              # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py        # –ò–º–ø–æ—Ä—Ç –≤—Å–µ—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ basic_commands.py  # –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã (/start, /help)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ photo_handler.py   # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ diary_handler.py   # –î–Ω–µ–≤–Ω–∏–∫ –ø–∏—Ç–∞–Ω–∏—è (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ gpt_analyzer.py    # –°–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç—ã —Å OpenAI API
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ user_service.py    # –°–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç—ã —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.py           # –ú–æ–¥–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ food_log.py       # –ú–æ–¥–µ–ª—å –∑–∞–ø–∏—Å–∏ –¥–Ω–µ–≤–Ω–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ locales/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ru/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ texts.py      # –í—Å–µ —Ç–µ–∫—Å—Ç—ã –Ω–∞ —Ä—É—Å—Å–∫–æ–º
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ base.py           # –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ keyboards/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main_menu.py      # –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ analysis_menu.py  # –ú–µ–Ω—é –∞–Ω–∞–ª–∏–∑–∞
‚îÇ   ‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ i18n.py           # –°–∏—Å—Ç–µ–º–∞ –∏–Ω—Ç–µ—Ä–Ω–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ prompts/
‚îÇ       ‚îî‚îÄ‚îÄ food_analysis.py  # –ü—Ä–æ–º—Ç—ã –¥–ª—è GPT
‚îú‚îÄ‚îÄ tests/                    # –¢–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ requirements.txt          # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ makefile                 # –ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
‚îî‚îÄ‚îÄ .env                     # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
```bash
git clone https://github.com/Ulianovskii/foodlens.git
cd foodlens
python -m venv venv
source venv/bin/activate  # Linux/Mac
# –∏–ª–∏ venv\Scripts\activate  # Windows
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
make install
# –∏–ª–∏
pip install -r requirements.txt
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```bash
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å .env —Ñ–∞–π–ª:
# BOT_TOKEN=your_telegram_bot_token
# OPENAI_API_KEY=your_openai_api_key
# DATABASE_URL=postgresql://user:pass@localhost/foodlens
```

### 4. –ó–∞–ø—É—Å–∫
```bash
make run
# –∏–ª–∏
python -m app.bot
```

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã Makefile:
```bash
make install    # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
make run        # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
make restart    # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞
make test       # –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
```

## –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

### –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö:

#### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (User):
```python
@dataclass
class User:
    user_id: int
    created_at: datetime
    language: str = "ru"
    # –ë—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –ú–æ–¥—É–ª–µ 4:
    # subscription_type: str = "free"
    # daily_photos_used: int = 0
    # subscription_until: datetime = None
```

#### –ó–∞–ø–∏—Å—å –¥–Ω–µ–≤–Ω–∏–∫–∞ (FoodLog):
```python
@dataclass  
class FoodLog:
    id: int
    user_id: int
    dish_name: str
    calories: int
    proteins: float
    fats: float
    carbs: float
    weight: int
    created_at: datetime
```

### –†–∞–±–æ—Ç–∞ —Å –ë–î:
```python
from app.models.user import User
from app.models.food_log import FoodLog

# –ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
user = User(user_id=12345, created_at=datetime.now())
```

## –°–∏—Å—Ç–µ–º–∞ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ–∫—Å—Ç–æ–≤:
–í—Å–µ —Ç–µ–∫—Å—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `app/locales/ru/texts.py`:

```python
TEXTS = {
    'start': "–ü—Ä–∏–≤–µ—Ç! –Ø –±–æ—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –µ–¥—ã...",
    'analysis_result': "üî• {calories} –ö–∫–∞–ª\nüçó –ë: {proteins}–≥...",
    'add_to_diary': "üìù –î–æ–±–∞–≤–∏—Ç—å –≤ –¥–Ω–µ–≤–Ω–∏–∫",
    # ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã
}
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ:
```python
from app.core.i18n import get_text

# –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—Å—Ç –Ω–∞ —è–∑—ã–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
text = get_text(user_id, 'start')

# –¢–µ–∫—Å—Ç —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
text = get_text(user_id, 'analysis_result', 
                calories=500, proteins=30)
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤:
1. –î–æ–±–∞–≤–∏—Ç—å –∫–ª—é—á –≤ `app/locales/ru/texts.py`
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ `get_text(user_id, 'new_key')`

## –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞:
```python
from aiogram import Router, F
from aiogram.types import Message
from aiogram.filters import Command

router = Router()

@router.message(Command("start"))
async def cmd_start(message: Message):
    user_id = message.from_user.id
    text = get_text(user_id, 'start')
    await message.answer(text)

@router.message(F.photo)
async def handle_photo(message: Message):
    # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏
    pass
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏:

#### –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã (`basic_commands.py`):
- `/start` - –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
- `/help` - –ø–æ–º–æ—â—å
- `/cancel` - –æ—Ç–º–µ–Ω–∞ —Ç–µ–∫—É—â–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è

#### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ç–æ (`photo_handler.py`):
- –ü—Ä–∏–µ–º —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
- –ü–æ–∫–∞–∑ –º–µ–Ω—é –∞–Ω–∞–ª–∏–∑–∞
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–æ–∫ "–ö–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å" –∏ "–†–µ—Ü–µ–ø—Ç"

### FSM (Finite State Machine):
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –º–Ω–æ–≥–æ—à–∞–≥–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤:

```python
from aiogram.fsm.state import State, StatesGroup

class AnalysisStates(StatesGroup):
    waiting_for_photo = State()
    waiting_for_clarification = State()
```

## –°–µ—Ä–≤–∏—Å—ã –∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

### GPT –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä (`services/gpt_analyzer.py`):
```python
analyzer = GPTAnalyzer()
result = await analyzer.analyze_food_image(
    user_id=12345,
    image_file=photo_file,
    analysis_type="nutrition"
)
```

### –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:
- `analyze_food_image()` - –∞–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏
- `cleanup_sessions()` - –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Å–µ—Å—Å–∏–π
- `has_active_session()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏

## –†–∞–±–æ—Ç–∞ —Å GPT API

### –ü—Ä–æ–º—Ç—ã (`prompts/food_analysis.py`):
- `SYSTEM_PROMPT_NUTRITION` - –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç–∏
- `SYSTEM_PROMPT_RECIPE` - –¥–ª—è —Ä–µ—Ü–µ–ø—Ç–æ–≤
- `get_system_prompt()` - –≤—ã–±–æ—Ä –ø—Ä–æ–º—Ç–∞ –ø–æ —Ç–∏–ø—É –∞–Ω–∞–ª–∏–∑–∞

### –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ GPT:
```
üî• 500 –ö–∫–∞–ª
üçó –ë: 30–≥  ü•ë –ñ: 20–≥  üçö –£: 45–≥

üçΩÔ∏è –ù–∞–∑–≤–∞–Ω–∏–µ –±–ª—é–¥–∞
- üî• –ö–∞–ª–æ—Ä–∏–∏: 500 –∫–∫–∞–ª
- ‚öñÔ∏è –í–µ—Å: 300–≥
- üçó –ë–µ–ª–∫–∏: 30–≥
- ü•ë –ñ–∏—Ä—ã: 20–≥  
- üçö –£–≥–ª–µ–≤–æ–¥—ã: 45–≥
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:
```bash
make test
# –∏–ª–∏
pytest tests/
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤:
```
tests/
‚îú‚îÄ‚îÄ test_bot_handlers.py    # –¢–µ—Å—Ç—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
‚îú‚îÄ‚îÄ test_gpt_analyzer.py    # –¢–µ—Å—Ç—ã GPT —Å–µ—Ä–≤–∏—Å–∞
‚îú‚îÄ‚îÄ conftest.py            # –§–∏–∫—Å—Ç—É—Ä—ã
‚îî‚îÄ‚îÄ quick_test.py          # –ë—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã
```

### –ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∞:
```python
async def test_start_command():
    # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã /start
    pass
```

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

### –ü–æ—à–∞–≥–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å:

#### 1. –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- –ö–∞–∫–∞—è user story —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è?
- –ö–∞–∫–∏–µ —ç–∫—Ä–∞–Ω—ã/—Å–æ–æ–±—â–µ–Ω–∏—è –Ω—É–∂–Ω—ã?
- –ö–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω–∏—Ç—å –≤ –ë–î?

#### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤
–í `app/locales/ru/texts.py`:
```python
'new_feature_title': "–ó–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏",
'new_feature_description': "–û–ø–∏—Å–∞–Ω–∏–µ...",
```

#### 3. –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞
–í `app/handlers/`:
```python
# new_feature_handler.py
router = Router()

@router.message(Command("new_feature"))
async def cmd_new_feature(message: Message):
    # –õ–æ–≥–∏–∫–∞ –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
    pass
```

–ù–µ –∑–∞–±—ã—Ç—å –¥–æ–±–∞–≤–∏—Ç—å –≤ `app/handlers/__init__.py`:
```python
from .new_feature_handler import router as new_feature_router
router.include_router(new_feature_router)
```

#### 4. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
–í `app/keyboards/main_menu.py` –¥–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É.

#### 5. –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–∞ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)
–í `app/services/` —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª —Å –ª–æ–≥–∏–∫–æ–π.

#### 6. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é

### –ü—Ä–∏–º–µ—Ä: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã /diary

#### 1. –¢–µ–∫—Å—Ç—ã:
```python
# –≤ texts.py
'diary_title': "üìä –ú–æ–π –¥–Ω–µ–≤–Ω–∏–∫",
'diary_empty': "–í –¥–Ω–µ–≤–Ω–∏–∫–µ –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π",
```

#### 2. –û–±—Ä–∞–±–æ—Ç—á–∏–∫:
```python
# diary_handler.py
@router.message(Command("diary"))
async def cmd_diary(message: Message):
    user_id = message.from_user.id
    # –õ–æ–≥–∏–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞–ø–∏—Å–µ–π –¥–Ω–µ–≤–Ω–∏–∫–∞
    text = get_text(user_id, 'diary_title')
    await message.answer(text)
```

#### 3. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:
```python
# –≤ __init__.py
from .diary_handler import router as diary_router
router.include_router(diary_router)
```

## –í–∞–∂–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### 1. –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å
–í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å async:
```python
# –ü—Ä–∞–≤–∏–ª—å–Ω–æ
async def get_user_data(user_id: int) -> User:

# –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ  
def get_user_data(user_id: int) -> User:
```

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
```python
try:
    result = await analyzer.analyze_food_image(...)
except Exception as e:
    logger.error(f"–û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞: {e}")
    await message.answer("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞")
```

### 3. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```python
import logging
logger = logging.getLogger(__name__)

logger.info("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–∏–ª —Ñ–æ—Ç–æ")
logger.error("–û—à–∏–±–∫–∞ –ë–î", exc_info=True)
```

### 4. –¢–∏–ø–∏–∑–∞—Ü–∏—è
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å type hints:
```python
async def process_analysis(
    user_id: int, 
    image_file: BytesIO
) -> Dict[str, Any]:
```

## –ß–∞—Å—Ç—ã–µ –∑–∞–¥–∞—á–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∫–æ–º–∞–Ω–¥—ã:
1. –¢–µ–∫—Å—Ç—ã –≤ `texts.py`
2. –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤ `handlers/`
3. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ `__init__.py`
4. –ö–Ω–æ–ø–∫–∞ –≤ –º–µ–Ω—é (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

### –†–∞–±–æ—Ç–∞ —Å –ë–î:
1. –°–æ–∑–¥–∞—Ç—å –º–æ–¥–µ–ª—å –≤ `models/`
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ —Å–µ—Ä–≤–∏—Å–µ

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º API:
1. –°–æ–∑–¥–∞—Ç—å —Å–µ—Ä–≤–∏—Å –≤ `services/`
2. –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
3. –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Aiogram: https://docs.aiogram.dev/
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è OpenAI API: https://platform.openai.com/docs/
- –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø—Ä–æ–µ–∫—Ç–∞: https://github.com/Ulianovskii/foodlens
- –¢–µ–∫—É—â–∏–π —Ä–µ–ª–∏–∑ v0.3.0: https://github.com/Ulianovskii/foodlens/releases/tag/v0.3.0

---

**–î–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞:** 
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (`make install`)
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `.env` —Ñ–∞–π–ª
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ (`make run`)
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –æ—Ç–ø—Ä–∞–≤–∫—É —Ñ–æ—Ç–æ –±–æ—Ç—É

–ì–æ—Ç–æ–≤ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –ª—é–±—ã–µ –≤–æ–ø—Ä–æ—Å—ã –ø–æ –∫–æ–¥—É! üöÄ