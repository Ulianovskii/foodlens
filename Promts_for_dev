# –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–π —Å–µ—Å—Å–∏–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

## –ü—Ä–æ–µ–∫—Ç: FoodLens - Telegram –±–æ—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–∏—Ç–∞–Ω–∏—è

**–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** https://github.com/Ulianovskii/foodlens  
**–õ–æ–∫–∞–ª—å–Ω–∞—è –ø–∞–ø–∫–∞:** `/Users/andrew/Dev/foodlens`  
**–ö–æ–º–ø—å—é—Ç–µ—Ä:** MacBook M1 Pro

## üìã –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

### ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ:
- **–ú–æ–¥—É–ª—å 1-2**: –ë–∞–∑–æ–≤—ã–π –∫–∞—Ä–∫–∞—Å –±–æ—Ç–∞ (aiogram 3.x, –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è, Makefile)
- **–ú–æ–¥—É–ª—å 3**: –°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (US1) - **–ü–û–õ–ù–û–°–¢–¨–Æ –ì–û–¢–û–í–û**
  - GPT-4 Vision API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
  - –°–∏—Å—Ç–µ–º–∞ —Å–µ—Å—Å–∏–π —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º (1 —Ñ–æ—Ç–æ + 5 —É—Ç–æ—á–Ω–µ–Ω–∏–π)
  - Reply-–∫–Ω–æ–ø–∫–∏ "üìä –ö–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å"/"üë®‚Äçüç≥ –†–µ—Ü–µ–ø—Ç"
  - –ó–∞—â–∏—Ç–∞ –æ—Ç —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö —Ç–µ–º, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –≤–µ—Å–∞

### üîÑ –¢–µ–∫—É—â–∏–π –º–æ–¥—É–ª—å: –ú–æ–¥—É–ª—å 4 - –°–∏—Å—Ç–µ–º–∞ –ª–∏–º–∏—Ç–æ–≤ –∏ –ø—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
**–¶–µ–ª—å:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É —Ç–∞—Ä–∏—Ñ–æ–≤ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –∑–∞–ø—Ä–æ—Å–æ–≤

## üéØ –ó–∞–¥–∞—á–∏ –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–π —Å–µ—Å—Å–∏–∏

### –ú–æ–¥—É–ª—å 4: –°–∏—Å—Ç–µ–º–∞ –ª–∏–º–∏—Ç–æ–≤ –∏ –ø—Ä–æ—Ñ–∏–ª–∏
1. **–†–∞—Å—à–∏—Ä–∏—Ç—å –º–æ–¥–µ–ª—å User –≤ –ë–î:**
   - `subscription_type` (free/premium_week/premium_month)
   - `subscription_until` (timestamp)
   - `daily_photos_used`, `total_photos_analyzed`
   - `last_reset_date` –¥–ª—è —Å–±—Ä–æ—Å–∞ —Å—á–µ—Ç—á–∏–∫–æ–≤

2. **Middleware –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∑–∞–ø—Ä–æ—Å–æ–≤:**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —Ñ–æ—Ç–æ
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Å—á–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–æ—Ç–æ
   - –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞

3. **–°–∏—Å—Ç–µ–º–∞ —Ç–∞—Ä–∏—Ñ–æ–≤:**
   - –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π: 3 —Ñ–æ—Ç–æ/–¥–µ–Ω—å + —Ä–µ–∫–ª–∞–º–∞
   - –ü—Ä–µ–º–∏—É–º: 10 —Ñ–æ—Ç–æ/–¥–µ–Ω—å –±–µ–∑ —Ä–µ–∫–ª–∞–º—ã
   - –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π —Å–±—Ä–æ—Å —Å—á–µ—Ç—á–∏–∫–æ–≤ –≤ 00:00

4. **–û–±–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—Å—Ç—ã –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏:**
   - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–¥ —Ç–∞—Ä–∏—Ñ
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ª–∏–º–∏—Ç–∞—Ö
   - –†–µ–∫–ª–∞–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–ù–ï –ú–ï–ù–Ø–¢–¨)
```
app/
‚îú‚îÄ‚îÄ handlers/          # –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
‚îú‚îÄ‚îÄ locales/ru/        # –°–∏—Å—Ç–µ–º–∞ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ services/          # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ models/           # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ middlewares/      # Middleware –¥–ª—è –ª–∏–º–∏—Ç–æ–≤
```

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** `.env` —Ñ–∞–π–ª  
**–ó–∞–ø—É—Å–∫:** `make run`, `make install`  
**–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** PostgreSQL

## üìù –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –î–ª—è –ú–æ–¥—É–ª—è 4:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É `app/`
- –í—Å–µ —Ç–µ–∫—Å—Ç—ã –≤ `app/locales/ru/texts.py`
- –ù–æ–≤—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤ `app/handlers/`
- –ú–æ–¥–µ–ª–∏ –≤ `app/models/`
- Middleware –≤ `app/middlewares/`

### –ö–ª—é—á–µ–≤—ã–µ –∞—Å–ø–µ–∫—Ç—ã:
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** –ë–î –∏ API
- **Graceful degradation** –ø—Ä–∏ –∏—Å—á–µ—Ä–ø–∞–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã** –∫–Ω–æ–ø–æ–∫ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π

## üîÑ Workflow –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ø–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏):
1. **/start** ‚Üí –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ª–∏–º–∏—Ç–∞—Ö
2. **–û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ç–æ** ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞ ‚Üí –∞–Ω–∞–ª–∏–∑ –∏–ª–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
3. **–ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞** ‚Üí –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–µ–º–∏—É–º-—Ç–∞—Ä–∏—Ñ–∞
4. **–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π —Å–±—Ä–æ—Å** ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–æ–≤

## üöÄ –ì–æ—Ç–æ–≤—ã –Ω–∞—á–∞—Ç—å?

**–ü–µ—Ä–≤—ã–µ —à–∞–≥–∏ –¥–ª—è –ú–æ–¥—É–ª—è 4:**
1. –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ User
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å middleware –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∑–∞–ø—Ä–æ—Å–æ–≤  
3. –î–æ–±–∞–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É —Å–±—Ä–æ—Å–∞ —Å—á–µ—Ç—á–∏–∫–æ–≤ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
4. –û–±–Ω–æ–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–∏–º–∏—Ç–æ–≤

**–ù–∞—á–Ω–µ–º —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ User?** üöÄ